@{
    ViewBag.Title = "Delcaración Formal Nueva";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<!-- Content Wrapper. Contains page content -->
<style>

    .example-modal .modal {
        position: relative;
        top: auto;
        bottom: auto;
        right: auto;
        left: auto;
        display: block;
        z-index: 1;
    }

    .example-modal .modal {
        background: transparent !important;
    }
</style>
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            Agregar Nuevo
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="#">Declaración Formal</a></li>
            <li class="active">Declaración Formal</li>
        </ol>
    </section>
    <!-- Main content -->
    <section class="content">
        <div class="row">
            <!-- left column -->
            <div class="col-md-12">
                <!-- general form elements -->
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h2 class="box-title">Declaración Formal</h2>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="row">
                            <div class="col-xs-12 col-md-12">
                                <label>Documento</label>
                                <select class="form-control select2" id="tipo_check">
                                    <option selectd value="0">Selecciona</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-5">
                            <div class="col-xs-6 col-md-4">
                                <div class="form-group">
                                    <label>Cliente</label>
                                    <select class="form-control select2" style="width: 100%;" id="cliente">
                                        <option selected="selected">Selecciona</option>
                                        <option value="1">Ana Karen Solis</option>
                                        <option value="2">Pedro Sánchez</option>
                                        <option value="3">Carlos Pedrera</option>
                                        <option value="4">Teresa Altamirano</option>
                                        <option value="5">Mónica Perez</option>
                                        <option value="6">Ashanty Correa</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-xs-6 col-md-4">
                                <label>Folio</label>
                                <input type="text" class="form-control" id="folio" maxlength="20" />
                            </div>
                            <div class="col-xs-6 col-md-4">
                                <div class="form-group">
                                    <label>Fecha:</label>
                                    <div class="input-group date">
                                        <div class="input-group-addon">
                                            <i class="fa fa-calendar"></i>
                                        </div>
                                        <input type="text" class="form-control pull-right" id="datepicker">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-5">
                            <div class="col-xs-6 col-md-4">
                                <label>Testigo 1</label>
                                <input type="text" class="form-control" id="testigo1" />
                            </div>
                            <div class="col-xs-6 col-md-4">
                                <label>Testigo 2</label>
                                <input type="text" class="form-control" id="testigo2" />
                            </div>
                            <div class="col-xs-6 col-md-4">
                                <label>Antiguedad de conocer a la persona</label>
                                <input type="text" class="form-control" id="antiguedad" onkeypress="return isNumberKey(event)" maxlength="2" />
                            </div>
                        </div>
                        <hr />
                        <div class="row mt-5">
                            <div class="col-xs-2 col-md-2">
                                <button class="btn btn-sm btn-primary" id="btnAgregarGarantia" data-target="#modal_saveG" data-toggle="modal"><i class="fa fa-plus-circle"></i> Agregar</button>
                            </div>
                            <div class="col-xs-10 col-xs-10">
                                <table id="table-datos" class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Descripción</th>
                                            <th>Marca</th>
                                            <th>Modelo</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyDetalles"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- /.box-body -->
                    <div class="box-footer" align="center">
                        <button class="btn btn-success" onclick="addGarantia()"><i class="fa fa-save"></i> Guardar</button>
                    </div>

                </div>
                <!-- /.box -->
            </div>
            <!--/.col (left) -->
        </div>
        <!-- /.row -->
    </section>
    <!-- /.content -->
</div>
<!-- /.content-wrapper -->
<div class="modal modal-primary fade" id="modal_saveG">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <h4 class="modal-title">Agregar Garantia</h4>
            </div>
            <div class="modal-body" style="text-align:center">
                <div class="row">
                    <div class="col-xs-6 col-md-4">
                        <label>Descripción</label>
                        <input type="text" class="form-control" id="descripcion" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Marca</label>
                        <input type="text" class="form-control" id="marca" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Modelo</label>
                        <input type="text" class="form-control" id="modelo" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6 col-md-4">
                        <label>No. Serie</label>
                        <input type="text" class="form-control" id="serie" maxlength="20" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Año (prenda)</label>
                        <input type="text" class="form-control" id="ann_prenda" maxlength="2" onkeypress="return isNumberKey(event)" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Color</label>
                        <input type="text" class="form-control my-colorpicker1" id="color_prenda" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Ubicación</label>
                        <input type="text" class="form-control" id="ubicacion" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Uso actual de la prenda</label>
                        <input type="text" class="form-control" id="uso_actual" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Valor de compra($)</label>
                        <input type="text" class="form-control" id="valor_compra_prenda" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Estado de la prenda</label>
                        <input type="text" class="form-control" id="estado_prenda" />
                    </div>
                    <div class="col-xs-6 col-md-4">
                        <label>Valor actual de la prenda</label>
                        <input type="text" class="form-control" id="valor_actual_prenda" />
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="btn_garantia">Aceptar</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<script>
    $(document).ready(function () {
        $('.select2').select2();
        $('#valor_compra_prenda').maskMoney();
        $('#valor_actual_prenda').maskMoney();
        //Date picker
        $('#datepicker').datepicker({
            autoclose: true,
            dateFormat: 'dd/mm/yyyy',
            Default: "es"

        })
        $('.my-colorpicker1').colorpicker()
        $("#datepicker").keypress(function (event) { event.preventDefault(); });
        $("#color_prenda").keypress(function (event) { event.preventDefault(); });
        consultaContenidoCheck();

        $("#modal_saveG").on('show.bs.modal', function (event) {
            $("#descripcion").val("");
            $("#marca").val("");
            $("#modelo").val("");
            $("#serie").val("");
            $("#ann_prenda").val("");
            $("#color_prenda").val("");
            $("#ubicacion").val("");
            $("#uso_actual").val("");
            $("#estado_prenda").val("");
            $("#valor_compra_actual").val("0.00");
            $("#valor_actual_actual").val(0.00);
        });
        $('#table-datos').DataTable({
            'paging': true,
            'lengthChange': false,
            'searching': false,
            'ordering': true,
            'info': true,
            'autoWidth': false,
            "language": {
                "sProcessing": "Procesando...",
                "sLengthMenu": "Mostrar _MENU_ registros",
                "sZeroRecords": "No se encontraron resultados",
                "sEmptyTable": "Ningún dato disponible en esta tabla",
                "sInfo": "Registros del _START_ al _END_  total: _TOTAL_ ",
                "sInfoEmpty": "Sin registros",
                "sInfoFiltered": "(filtrado de un total de _MAX_ registros)",
                "sInfoPostFix": "",
                "sSearch": "Buscar:",
                "sUrl": "",
                "sInfoThousands": ",",
                "sLoadingRecords": "Cargando...",
                "oPaginate": {
                    "sFirst": "Primero",
                    "sLast": "Último",
                    "sNext": "Siguiente",
                    "sPrevious": "Anterior"
                },
                "oAria": {
                    "sSortAscending": ": Activar para ordenar la columna de manera ascendente",
                    "sSortDescending": ": Activar para ordenar la columna de manera descendente"
                }
            }
        });
    });
    var garantias = [];
    $('#btn_garantia').click(function () {
        garantias.push({
            "descripcion": $("#descripcion").val(),
            "marca": $("#marca").val(),
            "modelo": $("#modelo").val(),
            "serie": $("#serie").val(),
            "ann_prenda": $("#ann_prenda").val(),
            "color_prenda": $("#color_prenda").val(),
            "ubicacion": $("#ubicacion").val(),
            "uso_actual": $("#uso_actual").val(),
            "estado_prenda": $("#estado_prenda").val(),
            "valor_compra_actual": $("#valor_compra_actual").val(),
            "valor_actual_compra": $("#valor_actual_compra").val(),
        });
        var s = '';
        var n = 0;
        for (var i = 0; i < garantias.length; i++) {
            n = i + 1;
            s = "<tr><td>" + n + "</td><td>" + garantias[i].descripcion + "</td><td>" + garantias[i].marca + "</td><td>" + garantias[i].modelo + "</td><td><button class='btn btn-xs btn-danger' onClick='eliminaRow(" + n + ")'><i class='fa fa-remove'></i></button></td></tr>";
        }
        $("#bodyDetalles").append(s);
        $("#modal_saveG").modal("hide");
    });

    function eliminaRow(n) {
        var p = n - 1;
        garantias.splice(p, 1);

        $("#bodyDetalles").empty();
        var s = '';
        var n = 0;
        for (var i = 0; i < garantias.length; i++) {
            n = i + 1;
            s += "<tr><td>" + n + "</td><td>" + garantias[i].descripcion + "</td><td>" + garantias[i].marca + "</td><td>" + garantias[i].modelo + "</td><td><button class='btn btn-xs btn-danger' onClick='eliminaRow(" + n + ")'><i class='fa fa-remove'></i></button></td></tr>";
        }
        $("#bodyDetalles").append(s);
    }
</script>
